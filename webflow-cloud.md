Web flow cloud is out of beta and with that they introduced new cloud storage and database options in the form of SQL like key value storage and also object storage for simple things like images, files and things like that. So in this tutorial we're going to go through how to set up storage in your next.js project remembering of course this is in beta so things might change. It's worth saying that this tutorial assumes that you've created a Web Flow cloud project either from scratch using the Web Flow CLI or you've converted an existing Nex.js project. If you haven't done that yet, then I'll recommend this video which you can watch now for free. Once you've done that, you can follow this video to then add Web Flow storage. Anyway, let's get on with it. Okay. Depending on when you created your Web Flow Cloud project, you might have to go in here, click edit, and make some sort of change. I just changed the description here. And what that does, it just kicks it into gear to update this to enable storage. This happened on the 16th of July. So any projects you created before the 16th of July, you're going to need to do this. Any project you create from this point onwards, you don't have to worry about. So, I've opened up my project here inside of cursor. We're going to want to add a new array to our Wrangler.json SC file. Now, documentation is a bit confusing here. My projects have only ever deployed when I remove that migrations uh line of code there. For whatever reason, it doesn't do it. All I can say is remove that line of code, otherwise this won't work. Next, we're going to want to basically add a new bit of code to our package. JSON. If you created your project with the Web Flow CLI, this will already be in there. But because we haven't, we're going to have want to add this line of code. And this can be whatever you want. But CF type type gen will run Wrangler types environment interface Cloudflare Cloudfare EMV. Right? I'll leave everything down below so you can copy and paste this sort of stuff. But we need this line of code in our package JSON. And now we're going to want to run that command. CF typen. Oh, it's winging that that already exists, which actually it will already exist. It's just a empty kind of typing file. So if you remove that we can rerun it and it will recreate it and it will look like this. Now we need to start installing Drizzle. Now Drizzle is a library for declaring and handling or manipulating our database. So we're going to run mpm install drizzle OM. Great stuff. And we're going to want to run mpm install development drizzle kit tsx and better sql light. And with that we're going to create a new file called drizzle.config.ts and paste in these things. And this basically tells Drizzle where to look for the the schema file which we're going to create now where the output of the of the schemas are. And then obviously the we're using SQL light. Now, popping back into our package JSON, we're going to add two more lines of code here. We're going to add a script called DB generate, which is going to run drizzle kit generate, and then apply local, which is going to apply our database locally, so we can test it locally. Don't worry about that just yet. We're going to use them a little bit later on. We've set up everything now to kind of like start actually creating our database and doing things with the actual database inside the code. We've configured our project and now we can move on to the fun stuff. We need to create a schema file. And a schema file defines different database tables and the columns of the information that database actually needs. So ID, name, email, all that kind of stuff. So if we go into our source file here, if we create a new file, we basically want to create a schema folder inside of our database folder. And then in here, we're going to create an index.tsx. So just so we're clear, inside of source db schema, we're going to have an empty index.tsx file. however you want to create that. We're just going to create a users table. Again, this file will be full of all of the different database tables that you need uh that you want to access inside the app. And you can see that it's defining the types of the different columns of this table. So, ID is an integer. It's primary key. Name is a bit of text and it can't be null. Age is an integer and it can't be null. Email is a text and it can't be null and it's unique. This is Drizzle. This is a lesson all on of itself. So, we won't go too deep into this right now, but just know this schema file will just be where all the tables are defined and the actual columns of that table and what types they are. And now with that created, we're actually going to generate these schema files using the the commands that were the scripts that we put inside of package.json. We run mpm run dbgenerate. And you'll see a bit of movement over here. So inside of the drizzle file, this is going to be where our migrations are stored. And then we're going to apply that locally to our local database with npm run db apply local. So you can see it's actually asking for the migrations file now. So let's add it back in and run those migrations again. And we should have our database. Now when it comes to actually deploying with web flow later on we just have to remember that we might need to remove that. Basically I've had very inconsistent results sometimes that hasn't deployed when it's there. I've removed it and then it's deployed. So maybe this will get figured out. We are in beta after all. We've created our users table now inside of our database. Now, we want to be able to access that within our code. And we're going to create a file that we can reuse anywhere we want to access this database because it's the same bit of code that basically just connects to our database. We don't want to be rewriting that code. So, inside of source, inside of DB, we're going to create a new file called get DB. Get database. And you're going to simply want to paste this bit of code. You don't need to worry about it too much. just know that it gets our database either for dynamic roots or for static roots and we can reuse this all over our application whenever we're going to access those our database. If you want to learn all things related to React NexJS then I have a web flow cloud course over on my Patreon. That's patreon.com/zx5. So if you want to dig a little bit deeper into all of this sort of stuff that we're going to go through then I recommend checking out the course over there. The way we access our database is through API roots. Now, I would watch my previous episodes on this or go sign up to the course to learn a little bit more about API routes, but we're just going to create one now for the sake of demonstrating to you getting data from our database. So, inside of source app, we've already got our API folder here. We're going to create a new file and it's going to be users and then root.ts. And this will create a new users route and paste this code in. And if we run through it real quick, we're basically creating two endpoints under API/ users and we're creating a post request and we're creating get request. If you don't know about post and and get uh I briefly go over on web flow forms masterclass. So if you want to understand a little bit more about that, go and check that out. Ultimately the clue is in the name. So if you want to add content, if you want to add things to a database, use post. You want to post information. If you want to get things from a database, you use get. And this will all happen under the same URL. And we'll demonstrate that a little bit later on. And here we're actually getting the database. You see, we're doing it on each of these functions here. And that's why we created that separate file. So we have to rewrite all of that code all the time. And in our get request, we're just going to get from the database. We're going to select all users from the users table database. And again, we're using that schema which does multiple things to help us basically get that table and we're returning that list of users. Similarly, we're getting the database here. We're getting the name, age, and email that we post to this this endpoint and we're inserting that into the database. Now, I already know that TypeScript is going to wind a little bit later on if we use unused variables. And once again here if we don't use the error. So we'll do that and I think we're good to go. I think we're going to run into an error. But we'll run dev here and go to our website/appi/ users. This should perform a get request on that URL which is empty. We've got no users in our database. So this shows us that the roots are working. Everything is hunky dory. So let's add a user to the user database. We've got the endpoint to be able to do so. We've got no UI to do so. So basically I've got a line of code here which again you can copy and paste. Uh if I press up here then you can see we're performing a curve request and we're posting that. So we're hitting that post endpoint instead of the get endpoint here uh at users. We're setting the header of content type application JSON and then the data is name me age email. And that should run looks like it ran perfectly well. And if we refresh this here we'll see that we've added and we're getting users from the from the user database. So within our app, we just fetch that endpoint, pull in the users, and loop through them. So again, we go much deeper in the course, but this is just getting the uh database up and running. Oh, it's worth saying that I I think I when I was faffing around, it warned me that this wasn't imported in the next config. Now, you'll get an error if you refresh. Um it literally tell you in the terminal that you need to add this. This is something I added just behind the scenes there. So, with that, let's get this up on Web Flow Cloud. All right. So, if you Okay, see, I've just got um got an alias here that just does everything for me. Get push. Now, here we have a failed thing. So, what I'm going to do is, as I said in the beginning, is just remove this here. migrations and push that and we should see it deploy. So we're deploying which is a good sign and we've hit success. So let's go to our project. So API/ users and we have no users. So in the context of web flow again, how do we do this? Well, what you'll see is up here we've got a new bindings menu and you'll see that our database whatever we've named it and in this instance we call it database. We've got a new interface here where we can actually add items to the database. You'd select your, you know, list of databases that you have. And we've created this user database here. And we can just add, we can just add the info. And we've got a database. Now, again, you'll have an interface potentially to add and remove and edit items in this database. But you can also manage the database in here. And by going back to our app, we refresh that. And you'll see that our user has been added. So, a little bit finicky there, but once again, a reminder, this is in beta. And again, go check out my Patreon for a much deeper dive into all things React and Next.js to help you along your journey understanding and using Web Flow Cloud to its full potential. Let me know down in the comments any questions you have or things you want me to cover. Like, subscribe, and all the rest of it. Until next time, happy no coding.